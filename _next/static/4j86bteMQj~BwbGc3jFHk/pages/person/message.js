(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{28:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=m(a(16)),r=m(a(21)),o=m(a(18)),c=m(a(19)),i=m(a(17)),l=m(a(20)),s=m(a(8)),u=m(a(1));function m(e){return e&&e.__esModule?e:{default:e}}var f=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&(a[n[r]]=e[n[r]])}return a},d=function(e){function t(){return(0,o.default)(this,t),(0,i.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return(0,l.default)(t,e),(0,c.default)(t,[{key:"render",value:function(){var e,t,a=this.props,o=a.className,c=a.prefixCls,i=a.children,l=a.text,m=a.size,d=a.overflowCount,p=a.dot,b=a.corner,y=a.hot,g=f(a,["className","prefixCls","children","text","size","overflowCount","dot","corner","hot"]);d=d,l="number"==typeof l&&l>d?d+"+":l,p&&(l="");var h=(0,s.default)((e={},(0,r.default)(e,c+"-dot",p),(0,r.default)(e,c+"-dot-large",p&&"large"===m),(0,r.default)(e,c+"-text",!p&&!b),(0,r.default)(e,c+"-corner",b),(0,r.default)(e,c+"-corner-large",b&&"large"===m),e)),_=(0,s.default)(c,o,(t={},(0,r.default)(t,c+"-not-a-wrapper",!i),(0,r.default)(t,c+"-corner-wrapper",b),(0,r.default)(t,c+"-hot",!!y),(0,r.default)(t,c+"-corner-wrapper-large",b&&"large"===m),t));return u.default.createElement("span",{className:_},i,(l||p)&&u.default.createElement("sup",(0,n.default)({className:h},g),l))}}]),t}(u.default.Component);t.default=d,d.defaultProps={prefixCls:"am-badge",size:"small",overflowCount:99,dot:!1,corner:!1},e.exports=t.default},890:function(e,t,a){__NEXT_REGISTER_PAGE("/person/message",function(){return e.exports=a(981),{page:e.exports.default}})},981:function(e,t,a){"use strict";a.r(t);var n=a(28),r=a.n(n),o=a(1),c=a.n(o),i=a(6),l=a.n(i),s=a(5),u=a(3),m=a(10),f=a(4),d=a(0),p=a(2),b=a.n(p),y=[{title:"评论",numKey:"replyNum"},{title:"点赞",numKey:"likeNum"},{title:"私信",numKey:"chatNum"},{title:"@我",numKey:"commentNum"},{title:"系统",numKey:"systemNum"}],g=[{label:"反馈",value:[1,6]},{label:"动态",value:[2,3,4,5,7,51]},{label:"帖子",value:[52,101,102]},{label:"视讯",value:[50]}],h="style-117998",_=Object(s.d)(function(e){var t,a,n=e.userId,r=e.facePath,o=e.vip,i=e.niname,l=e.con,s=e.sourceCon,p=e.msgType,y=e.relevId,_=e.createTime;switch((g.find(function(e){return-1!==e.value.indexOf(parseInt(p))})||{}).label){case"动态":t="/discovery/detail?id=".concat(y),a="/discovery/detail/".concat(y);break;case"帖子":t="/bbs/article?id=".concat(y),a="/bbs/article/".concat(y);break;case"视讯":t="/video/detail?id=".concat(y),a="/video/detail/".concat(y);break;case"反馈":t="/person/feedback/detail?id=".concat(y),a="/person/feedback/detail/".concat(y)}return c.a.createElement(u.u.Item,{thumb:c.a.createElement(m.c,{userId:n,img:r,vip:o}),thumbPosition:"top"},c.a.createElement(u.l,{align:"start"},c.a.createElement(u.l.Item,null,c.a.createElement("p",{className:b.a.dynamic([["1443648086",[h,h,h,d.a.xs,d.a.color_inner,d.a.radius_sm]]])+" t-30 l-44 t-main ls-o1"},i),c.a.createElement(u.e,{className:"".concat(h,"__content t-28 l-36 mt-8")},l),c.a.createElement("p",{className:b.a.dynamic([["1443648086",[h,h,h,d.a.xs,d.a.color_inner,d.a.radius_sm]]])+" t-24 l-32 t-sub mt-8"},f.a.date(_))),c.a.createElement(u.l,{className:"".concat(h,"__extra ml-sm"),justify:"center",href:t,as:a},c.a.createElement("p",{className:b.a.dynamic([["1443648086",[h,h,h,d.a.xs,d.a.color_inner,d.a.radius_sm]]])+" t-20 t-sub t-c4"},f.a.getCharFilterEmoji(s)))),c.a.createElement(b.a,{styleId:"1443648086",css:".".concat(h,"__content .tool-emoji{width:0.36rem !important;height:0.36rem !important;}.").concat(h,"__content .tool-emoji-lg{width:0.48rem !important;min-width:0.48rem !important;height:0.48rem !important;min-height:0.48rem !important;}.").concat(h,"__extra{width:1.38rem;height:1.28rem;padding:").concat(d.a.xs,";background-color:").concat(d.a.color_inner,";border-radius:").concat(d.a.radius_sm,";overflow:hidden;background-position:center center;}"),dynamic:[h,h,h,d.a.xs,d.a.color_inner,d.a.radius_sm]}))}),v=Object(s.d)(function(e){var t=e.data,a=void 0===t?{}:t,n=e.onEndReached;return c.a.createElement(u.v,{data:a,renderRow:function(e){return c.a.createElement(_,e)},onEndReached:n})}),E=Object(s.d)(function(e){var t,a=e.userId,n=e.faceImg,o=e.niname,i=e.message,l=e.newNum,s=e.createTime,p={};try{p=JSON.parse(i)}catch(e){}return t=f.a.date("m-d",s)===f.a.date("m-d",f.a.getTimestamp()/1e3)?f.a.date("H:i",s):f.a.date("m-d",s),c.a.createElement(u.u.Item,{thumb:c.a.createElement(m.c,{userId:a,img:n}),href:"/chat?id=".concat(a),as:"/chat/".concat(a)},c.a.createElement(u.l,{align:"start"},c.a.createElement(u.l.Item,null,c.a.createElement("p",{className:"t-30 l-44 t-main ls-o1"},o),c.a.createElement("p",{className:"t-24 l-36 t-sub t-c1 mt-8"},p.id?"[图片]":p.value)),c.a.createElement("div",null,c.a.createElement("p",{className:"t-24 l-36 t-sub mt-8"},t),l>0&&c.a.createElement(r.a,{className:"pull-right mt-8",text:l,style:d.a._badgeFill}))))}),w=function(e,t){var a=t.$,n=a.getState("privateMessage");return c.a.createElement(u.v,{data:n,renderRow:function(e){return c.a.createElement(E,e)},onEndReached:a.fetch.privateMessage})};w.contextTypes={$:l.a.object};var O,S,T=Object(s.d)(w),k=a(9),x=a.n(k),j=a(11),C=a(12),P=a(7),N=a(13);function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t,a,n,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function z(e){return function(){var t=this,a=arguments;return new Promise(function(n,r){var o=e.apply(t,a);function c(e){I(o,n,r,c,i,"next",e)}function i(e){I(o,n,r,c,i,"throw",e)}c(void 0)})}}function R(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function K(e,t){return(K=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var $,F,J,A,D,G,X=(O=function(e){function t(){var e,a,n,r,o,c,i,l,s,u;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var m=arguments.length,d=new Array(m),p=0;p<m;p++)d[p]=arguments[p];return n=this,r=(e=L(t)).call.apply(e,[this].concat(d)),a=!r||"object"!==M(r)&&"function"!=typeof r?Y(n):r,o=a,c="state",i=S,l=Y(Y(a)),i&&Object.defineProperty(o,c,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(l):void 0}),a.fetch={config:{update:["messageCount","reply"]},messageCount:(s=z(x.a.mark(function e(){var t;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=N.a.fetchMessageCount(),e.t0=a,e.next=4,t;case 4:return e.t1=e.sent,e.t0.setState.call(e.t0,e.t1,"messageCount"),e.abrupt("return",t);case 7:case"end":return e.stop()}},e,this)})),function(){return s.apply(this,arguments)}),reply:function(e){return a.fetchListThenSetState("get_message_list","reply",{_:{limit:P.a.__LIMIT__,search:{msgType:[2,3,101,102]}}},e)},like:function(e){return a.fetchListThenSetState("get_message_list","like",{_:{limit:P.a.__LIMIT__,search:{msgType:[4,5]}}},e)},comment:function(e){return a.fetchListThenSetState("get_message_list","comment",{_:{limit:P.a.__LIMIT__,search:{msgType:[7]}}},e)},system:function(e){return a.fetchListThenSetState("get_message_list","system",{_:{limit:P.a.__LIMIT__,search:{msgType:[1,6]}}},e)},privateMessage:function(e){return a.fetchListThenSetState("get_chat_private-notice","privateMessage",{},e)}},a.do={clear:(u=z(x.a.mark(function e(t){return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.a.doClearMessageCount(t);case 2:a.setState(N.a.getState("messageCount"),"messageCount");case 3:case"end":return e.stop()}},e,this)})),function(e){return u.apply(this,arguments)})},a.page={onTabClick:function(e,t){a.setState({page:t},"_affixTabs"),a.do.clear(y[t].key),a.page.fetchNextTab(t),f.a.scrollTo(0)},fetchNextTab:function(e){switch(y[e].title){case"点赞":a.getState("like")._loaded||a.fetch.like();break;case"@我":a.getState("comment")._loaded||a.fetch.comment();break;case"系统":a.getState("system")._loaded||a.fetch.system();break;case"私信":a.getState("privateMessage")._loaded||a.fetch.privateMessage()}}},a}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&K(e,t)}(t,C["a"]),a=t,(n=[{key:"storeDidMount",value:function(){setTimeout(function(){N.a.doClearMessageCount(y[0].key)},4e3)}}])&&R(a.prototype,n),r&&R(a,r),t}(),$=O.prototype,F="state",J=[j.k],A={configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.initState({_affixTabs:{page:0},messageCount:N.a.getState("messageCount"),reply:P.a.__EMPTY__,like:P.a.__EMPTY__,comment:P.a.__EMPTY__,system:P.a.__EMPTY__,privateMessage:P.a.__EMPTY__})}},G={},Object.keys(A).forEach(function(e){G[e]=A[e]}),G.enumerable=!!G.enumerable,G.configurable=!!G.configurable,("value"in G||G.initializer)&&(G.writable=!0),G=J.slice().reverse().reduce(function(e,t){return t($,F,e)||e},G),D&&void 0!==G.initializer&&(G.value=G.initializer?G.initializer.call(D):void 0,G.initializer=void 0),void 0===G.initializer&&(Object.defineProperty($,F,G),G=null),S=G,O);function H(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var q=function(e,t){var a=t.$,n=a.getState("_affixTabs").page,o=a.getState("messageCount"),i=a.getState("reply"),l=a.getState("like"),s=a.getState("comment"),p=a.getState("system"),b=f.a.deepCopy(y);return o._loaded&&b.forEach(function(e,t){0!=o[e.numKey]&&(b[t].title=c.a.createElement("p",{style:{position:"relative"}},c.a.createElement("span",{className:"t-30"},e.title),c.a.createElement(r.a,{text:o[e.numKey],style:function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){H(e,t,a[t])})}return e}({},d.a._badgeFill,{position:"absolute",top:"-0.32rem",transform:"translateX(-0.04rem)"})})))}),c.a.createElement(m.k,{className:"style-121896",title:"我的消息"},c.a.createElement(u.a,{tabs:b,page:n,animated:!0,onTabClick:a.page.onTabClick},c.a.createElement(v,{data:i,onEndReached:a.fetch.reply}),c.a.createElement(v,{data:l,onEndReached:a.fetch.like}),c.a.createElement(T,null),c.a.createElement(v,{data:s,onEndReached:a.fetch.comment}),c.a.createElement(v,{data:p,onEndReached:a.fetch.system})))};q.contextTypes={$:l.a.object};var B=Object(s.c)(X)(Object(s.d)(q));t.default=B}},[[890,1,0]]]);