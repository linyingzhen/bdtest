(window.webpackJsonp=window.webpackJsonp||[]).push([[123],{38:function(e,t,a){"use strict";var n=a(2),r=a.n(n),o=a(1),c=a.n(o),i=a(8),l=a.n(i),s=a(5),m=a(3),u=a(4),d=a(0);t.a=Object(s.d)(function(e){var t,a,n,o=e.tag,i=e.nowTime,s=e.beginTime,p=e.endTime,f=e.className;switch(o){case"预告中":t=s,a="倒数",n="main";break;case"进行中":t=p,a="剩余",n="primary";break;case"已结束":n="default"}return c.a.createElement("div",{className:r.a.dynamic([["1364954403",[d.a.color_inner]],["3293149964",[d.a.color_void,d.a.color_main,d.a.color_primary,d.a.color_sub]]])},"预告中"===o&&c.a.createElement(m.l,{className:l()("style-110292",f)},c.a.createElement("p",{className:r.a.dynamic([["1364954403",[d.a.color_inner]],["3293149964",[d.a.color_void,d.a.color_main,d.a.color_primary,d.a.color_sub]]])+" "+"tag tag-".concat(n)},"预告中"),c.a.createElement(m.l.Item,{className:"t-24 l-34"},u.a.date("m-d H:i:s",s)," 开始")),"进行中"===o&&c.a.createElement(m.l,{className:l()("style-110292",f,"t-sub")},c.a.createElement("p",{className:r.a.dynamic([["1364954403",[d.a.color_inner]],["3293149964",[d.a.color_void,d.a.color_main,d.a.color_primary,d.a.color_sub]]])+" "+"tag tag-".concat(n)},"进行中"),c.a.createElement(m.l.Item,null,c.a.createElement(m.f,{className:"t-24 l-34",theme:!1,left:a,now:Number(i),beginTime:Number(t)}))),"已结束"===o&&c.a.createElement("p",{className:r.a.dynamic([["1364954403",[d.a.color_inner]],["3293149964",[d.a.color_void,d.a.color_main,d.a.color_primary,d.a.color_sub]]])+" "+(l()("tag tag-".concat(n),f)||"")},"已结束"),c.a.createElement(r.a,{styleId:"1364954403",css:".style-110292{background:".concat(d.a.color_inner,";}"),dynamic:[d.a.color_inner]}),c.a.createElement(r.a,{styleId:"3293149964",css:".tag.__jsx-style-dynamic-selector{display:inline-block;width:0.96rem;height:0.56rem;font-size:0.24rem;line-height:0.56rem;text-align:center;color:".concat(d.a.color_void,";}.tag-main.__jsx-style-dynamic-selector{background:").concat(d.a.color_main,";}.tag-primary.__jsx-style-dynamic-selector{background:").concat(d.a.color_primary,";}.tag-default.__jsx-style-dynamic-selector{background:").concat(d.a.color_sub,";}"),dynamic:[d.a.color_void,d.a.color_main,d.a.color_primary,d.a.color_sub]}))})},936:function(e,t,a){__NEXT_REGISTER_PAGE("/shop/miaosha/detail",function(){return e.exports=a(970),{page:e.exports.default}})},970:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),o=a(6),c=a.n(o),i=a(5),l=a(10),s=a(3),m=a(4),u=a(0);function d(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var p=function(e,t){var a=t.$,n=a.getState("_imgView"),o=n.show,c=n.index,i=a.getState("detail"),l=i.imgs,p=void 0===l?"":l,f=i.imglist,y=[p].concat(d((void 0===f?"":f).split(","))).filter(function(e){return""!==e}).map(function(e){return m.a.getImgUrl(e)});return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.d,{data:y.map(function(e){return{src:e}}),height:"96vw",style:{backgroundColor:u.a.color_theme},onImgClick:a.page.showImgView}),!!y.length&&r.a.createElement(s.r,{show:o,data:y,current:c,hideOrigin:!0,onClose:a.page.hideImgView}))};p.contextTypes={$:c.a.object};var f=Object(i.d)(p),y=a(2),b=a.n(y),h=a(38),g=function(e,t){var a,n,o=t.$,c=o.getState("detail"),i=c.title,l=c.property,m=c.nowTime,d=c.beginTime,p=c.endTime,f=c.salePrice,y=c.dataType,g=c.panicType,_=c.tag,E=c._loaded;return 2==y?1==g?(a="本汀余额",n=r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"t-danger ml-xs"},"¥"),r.a.createElement("span",{className:"t-34 l-34 t-danger mr-xs"},parseFloat(f)))):(a="金币",n=r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"t-34 l-34 t-danger ml-xs"},1e3*f/100),r.a.createElement("span",{className:"t-danger mr-xs"},"金币"))):(a="灵动余额",n=r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"t-danger ml-xs"},"¥"),r.a.createElement("span",{className:"t-34 l-34 t-danger mr-xs"},parseFloat(f)))),r.a.createElement("div",{className:b.a.dynamic([["3535931777",[u.a.wind,u.a.color_theme]]])+" style-414741"},E&&r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{className:b.a.dynamic([["3535931777",[u.a.wind,u.a.color_theme]]])+" t-34 l-48"},i),l&&r.a.createElement("p",{className:b.a.dynamic([["3535931777",[u.a.wind,u.a.color_theme]]])+" t-24 l-32 t-sub mt-4"},l),r.a.createElement(h.a,{className:"mt-24",tag:_,nowTime:m,beginTime:d,endTime:p,onEnd:function(){return setTimeout(function(){o.fetch.detail(),o.fetch.record(!0)},1e3)}}),r.a.createElement(s.l,{className:"mt-24"},r.a.createElement(s.l.Item,{className:"t-22 l-32"},r.a.createElement("span",{className:b.a.dynamic([["3535931777",[u.a.wind,u.a.color_theme]]])+"  t-sub"},"秒杀价"),n),r.a.createElement("span",{className:b.a.dynamic([["3535931777",[u.a.wind,u.a.color_theme]]])+" t-22 l-32 t-sub"},a))),r.a.createElement(b.a,{styleId:"3535931777",css:".style-414741.__jsx-style-dynamic-selector{min-height:2.58rem;padding:0.32rem ".concat(u.a.wind,";background:").concat(u.a.color_theme,";}"),dynamic:[u.a.wind,u.a.color_theme]}))};g.contextTypes={$:c.a.object};var _=Object(i.d)(g),E=a(8),w=a.n(E),v=Object(i.d)(function(e){var t=e.userId,a=e.faceImg,n=e.niname,o=e.createTime;return r.a.createElement(s.u.Item,{thumb:r.a.createElement(l.c,{userId:t,img:a})},r.a.createElement(s.l,null,r.a.createElement(s.l.Item,null,r.a.createElement("p",{className:"t-30 l-44"},n),r.a.createElement("p",{className:"t-24 l-36 t-sub"},m.a.date("m-d H:i:s",o))),r.a.createElement("p",{className:"t-30 l-44 t-danger"},"成功秒杀")))}),j=function(e,t){var a=t.$,n=e.className,o=a.getState("record");return r.a.createElement("div",{className:w()("style-621643",n)},r.a.createElement(l.i,{title:"参与记录",isList:!!o.list.length}),r.a.createElement(s.v,{data:o,renderRow:function(e){return r.a.createElement(v,e)},onEndReached:a.fetch.record}))};j.contextTypes={$:c.a.object};var N=Object(i.d)(j),T=function(e,t){var a=t.$,n=e.tag,o=a.getState("detail").perNum;return"预告中"===n?r.a.createElement("div",{className:"tool-fixed"},r.a.createElement(s.c,{type:"primary"},"未开始")):"进行中"===n?r.a.createElement("div",{className:"tool-fixed"},r.a.createElement(s.c,{type:"primary",onClick:function(){return m.a.checkLogin(a.page.showPayConfirm)}},"立即秒杀")):r.a.createElement("div",{className:"tool-fixed"},r.a.createElement(s.c,{type:"primary"},0==o?"已抢光":"已结束"))};T.contextTypes={$:c.a.object};var O,x,S,I=Object(i.d)(T);function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function C(e,t){return!t||"object"!==P(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $(e){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function z(e,t){return(z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var V,A,F=Object(i.d)((S=x=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),C(this,$(t).apply(this,arguments))}var a,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&z(e,t)}(t,r.a.Component),a=t,(n=[{key:"componentWillUnmount",value:function(){this.context.$.page.hidePayConfirm()}},{key:"render",value:function(){if("进行中"!==this.props.tag)return null;var e,t,a,n=this.context.$,o=n.getState("_payConfirm").show,c=n.getState("detail"),i=c.dataType,l=c.panicType,m=c.salePrice;return 2==i?1==l?(e="amount",t=2,a=m):(e="coin",a=1e3*m/100):(e="amount",t=1,a=m),r.a.createElement(s.y,{show:o,type:e,dataType:t,amount:a,onClose:n.page.hidePayConfirm,onConfirm:n.do.miaosha})}}])&&k(a.prototype,n),o&&k(a,o),t}(),x.contextTypes={$:c.a.object},O=S))||O,R=a(9),L=a.n(R),G=a(11),H=a(12),J=a(15),M=a(7);function U(e){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e,t,a,n,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function X(e){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Y(e,t){return(Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var B,D,K,Q,Z,ee,te=(V=function(e){function t(){var e,a,n,r,o,c,i,l,s,u;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];return n=this,r=(e=X(t)).call.apply(e,[this].concat(p)),a=!r||"object"!==U(r)&&"function"!=typeof r?q(n):r,o=a,c="state",i=A,l=q(q(a)),i&&Object.defineProperty(o,c,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(l):void 0}),a.fetch={config:{update:["detail","record"]},detail:function(){var e=a.params.params.id;return a.fetchThenSetState("get_shop_miaosha-detail","detail",{panicId:e})},record:function(e){var t=a.params.params.id;return a.fetchListThenSetState("get_shop_miaosha-record","record",{_:{limit:M.a.__LIMIT__,search:{panicId:t}}},e)}},a.do={miaosha:(s=L.a.mark(function e(){var t,n,r,o,c;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.getState("detail"),n=t.panicId,r=t.panicType,e.next=3,J.a.P("do_shop_miaosha",{panicId:n});case 3:o=e.sent,c=o.orderNo,a.page.hidePayConfirm(),a.fetch.detail(),a.fetch.record(!0),1==r&&m.a.router.push("/pay/result?id=".concat(c),"/pay/result/".concat(c));case 9:case"end":return e.stop()}},e,this)}),u=function(){var e=this,t=arguments;return new Promise(function(a,n){var r=s.apply(e,t);function o(e){W(r,a,n,o,c,"next",e)}function c(e){W(r,a,n,o,c,"throw",e)}o(void 0)})},function(){return u.apply(this,arguments)})},a.page={showImgView:function(e){return a.setState({show:!0,index:e},"_imgView")},hideImgView:function(){return a.setState({show:!1},"_imgView")},showPayConfirm:function(){return a.setState({show:!0},"_payConfirm")},hidePayConfirm:function(){return a.setState({show:!1},"_payConfirm")}},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y(e,t)}(t,H["a"]),t}(),B=V.prototype,D="state",K=[G.k],Q={configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.initState({_payConfirm:{show:!1,amount:0,addPrice:0},_imgView:{show:!1,index:0},detail:{},record:M.a.__EMPTY__})}},ee={},Object.keys(Q).forEach(function(e){ee[e]=Q[e]}),ee.enumerable=!!ee.enumerable,ee.configurable=!!ee.configurable,("value"in ee||ee.initializer)&&(ee.writable=!0),ee=K.slice().reverse().reduce(function(e,t){return t(B,D,e)||e},ee),Z&&void 0!==ee.initializer&&(ee.value=ee.initializer?ee.initializer.call(Z):void 0,ee.initializer=void 0),void 0===ee.initializer&&(Object.defineProperty(B,D,ee),ee=null),A=ee,V),ae=function(e,t){var a,n,o,c=t.$.getState("detail"),i=c.nowTime,s=c.beginTime,m=c.endTime,u=c.perNum,d=c._loaded,p=(a=m,o=u,(n=i)<=s?"预告中":!o||a&&n>a?"已结束":"进行中");return r.a.createElement(l.k,{title:"秒杀详情"},r.a.createElement(f,null),r.a.createElement(_,{tag:p}),r.a.createElement(N,{className:"mt-d"}),d&&r.a.createElement(I,{tag:p}),d&&r.a.createElement(F,{tag:p}))};ae.contextTypes={$:c.a.object};var ne=Object(i.c)(te)(Object(i.d)(ae));t.default=ne}},[[936,1,0]]]);